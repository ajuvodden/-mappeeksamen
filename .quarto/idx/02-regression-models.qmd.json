{"title":"Regression Models","markdown":{"yaml":{"title":"Regression Models","author":"Andrine Juvodden, gruppeoppgave","format":{"html":{"citation-style":"resources/apa.csl.txt","code-fold":true}},"bibliography":"resources/idr-4000-referanser.bib","output":"html_document","editor_options":{"chunk_output_type":"console"},"execute":{"echo":false,"warning":false,"message":false}},"headingText":"Introduksjon","containsRefs":false,"markdown":"\n\n\nDenne oppgaven er delt inn i tre deler, som hver fokuserer på ulike konsepter innen dataanalyse og regresjon. I del 1 beregner vi laktatterskler og undersøker reliabiliteten mellom to ulike terskelnivåer. I del 2 benytter vi molekylære data for å forutsi størrelsen på DNA-fragmenter. Til slutt, i del 3, undersøker vi om det er en lineær sammenheng mellom valgte variabler fra datasettet hypertrophy i datapakken exscidata.\n\n## Del 1: Laktatterskler\n\n### Introduksjon\n\nLaktatterskel er en vitkig variabel for å predikere prestasjoner i utholdenhetsidretter, og brukes både til å justere treningsintenistet og evaluere effekten av trening (@Machado2012). Det finnes flere metoder for å bestemme en utøvers laktatterskel, og ifølge @Machado2012 er \"maximal-deviation method\" (Dmax), som ble anbefalt av Cheng et al. i 1992, en av de mest pålitelige. Denne metoden er spesielt nyttig for å vurdere mekanismene som påvirker prestasjon i langdistanseidretter, og har vist seg å ha en sterkere korrelasjon med både prestasjon og laktatterskel sammenlignet med andre metoder. De representative tersklene som blir undersøkt er (). Dette kan oppnås ved å bruke en regresjonsmodell for å beskrive forholdet, og deretter utføre en \"invers prediksjon\" av treningsintensiteten @Tanner2012.\n\n### Metode\n\nSom vi kan se i den plotta grafen under, er de forskjellige grafene ikke så forskjellige rundt 2mmol og 4mmol L\\~-1. På den andre siden ser vi at den lineære modellen er feil ved 300w, den sekundærplynomiske modellen er feil ved 275w. Den tredje- og fjerdeplynomiske modellen derimot, varierer ikke mye fra hverandre.\n\n```{r}\n\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(exscidata)\nlibrary(knitr)\n\ndata(\"cyclingstudy\")\n\ncyclingstudy %>%\n  select(subject, group, timepoint, lac.225:lac.375) %>%\n  filter(timepoint == \"pre\", subject == 10) %>%\n  pivot_longer(\n    cols = lac.225:lac.375,\n    names_to = \"watt\",\n    values_to = \"lactate\",\n    names_prefix = \"lac.\",\n    names_transform = list(watt = as.numeric)\n  ) %>%\n\n    ggplot(aes(x = watt, y = lactate, group = subject)) +\n  geom_line(linetype = 2) + \n  geom_point(shape = 21, fill = \"lightblue\", size = 2.5) +  \n  \n  geom_hline(yintercept = 4, color = \"red\") +\n  geom_hline(yintercept = 2, color = \"gold\") +\n  \n  geom_vline(xintercept = 341.5, color = \"blue\") +\n  geom_vline(xintercept = 308, color = \"green\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ x, color = \"#e41a1c\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ poly(x, 2), color = \"#377eb8\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ poly(x, 3), color = \"#4daf4a\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ poly(x, 4), color = \"#ff7f00\")\n\n\n```\n\nFor å finne ut hva forutsatt wattverdi som er nærmest 2 og 4 mmol L-1, benytter vi koden under:\n\n```{r}\n\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(exscidata)\nlibrary(knitr)\n\ndata(\"cyclingstudy\")\n\n# Filter data\ncycling_filtered <- cyclingstudy %>%\n  select(subject, group, timepoint, lac.225:lac.375) %>%\n  filter(timepoint == \"pre\", subject == 10) %>%\n  pivot_longer(\n    cols = lac.225:lac.375,\n    names_to = \"watt\",\n    values_to = \"lactate\",\n    names_prefix = \"lac.\",\n    names_transform = list(watt = as.numeric)\n  )\n\n# Tilpass en polynommodell av 3. grad\nm3 <- lm(lactate ~ poly(watt, 3), data = cycling_filtered)\n\n# Ny dataramme for prediksjoner\nndf <- data.frame(watt = seq(from = 225, to = 375, by = 0.1))\nndf$predictions <- predict(m3, newdata = ndf)\n\n# Finn wattverdiene nærmest 2 mmol/L og 4 mmol/L\nlactate_threshold_2 <- ndf %>%\n  filter(abs(predictions - 2) == min(abs(predictions - 2)))\n\nlactate_threshold_4 <- ndf %>%\n  filter(abs(predictions - 4) == min(abs(predictions - 4)))\n\n# Resultater\nprint(lactate_threshold_2)\nprint(lactate_threshold_4)\n\n# Plot data and the model\nggplot(cycling_filtered, aes(x = watt, y = lactate)) +\n  geom_point(shape = 21, fill = \"lightblue\", size = 2.5) +  # Plot the data points\n  geom_line(color = \"black\", linetype = \"dashed\") +  # Add the line for the model\n  geom_hline(yintercept = c(2, 4), color = c(\"gold\", \"red\"), linetype = \"dotted\") +  # Add horizontal lines for 2 and 4 mmol/L\n  geom_vline(xintercept = lactate_threshold_2$watt, color = \"green\", linetype = \"solid\") +  # Vertical line for 2 mmol/L\n  geom_vline(xintercept = lactate_threshold_4$watt, color = \"blue\", linetype = \"solid\") +  # Vertical line for 4 mmol/L\n  theme_minimal() +\n  labs(title = \"Laktatnivå versus Watt\", x = \"Watt\", y = \"Laktatnivå\")\n\n```\n\nRegresjonsanalysen viser at wattverdien som gir et laktatnivå på 2 mmol L-1 er omtrent 311 watt. Når intensiteten når 311 watt, forventes laktatnivået å være nær 2 mmol L-1. laktatnivået på 4 mmol L-1, ligger predikerte wattverdien på 343 watt. Disse resultatene kan brukes til å vurdere intenisten på treningsøktene i forhold til laktatterskelene.\n\nFor å sammenligne reliabiliten (SD som en prosent av gjennomsnittet) mellom lac.225 og lac.375, kan vi formulere koden slik:\n\n```{r, results='hide'}\n\n# Filtrer ut NA-verdier for lac.225 og lac.375\nlac_data_225 <- cyclingstudy %>%\n  filter(!is.na(lac.225)) %>%\n  select(subject, lac.225)\n\nlac_data_375 <- cyclingstudy %>%\n  filter(!is.na(lac.375)) %>%\n  select(subject, lac.375)\n\n# Sjekk antall rader i dataene for lac.225 og lac.375\ncat(\"Antall rader i lac_data_225:\", nrow(lac_data_225), \"\\n\")\ncat(\"Antall rader i lac_data_375:\", nrow(lac_data_375), \"\\n\")\n\n# Beregn standardfeil, gjennomsnitt og prosentandel for lac.225\nse_lac225 <- sd(lac_data_225$lac.225) / sqrt(length(lac_data_225$lac.225))\nmean_lac225 <- mean(lac_data_225$lac.225)\nperc_se_lac225 <- (se_lac225 / mean_lac225) * 100\n\n# Beregn standardfeil, gjennomsnitt og prosentandel for lac.375\nse_lac375 <- sd(lac_data_375$lac.375) / sqrt(length(lac_data_375$lac.375))\nmean_lac375 <- mean(lac_data_375$lac.375)\nperc_se_lac375 <- (se_lac375 / mean_lac375) * 100\n\n# Skriv ut resultatene\ncat(\"Typisk feil som prosentandel for lac.225:\", perc_se_lac225, \"%\\n\")\ncat(\"Typisk feil som prosentandel for lac.375:\", perc_se_lac375, \"%\\n\")\n\n\n```\n\nResultatene viser at den typiske feilen som prosentandel av gjennomsnittet er 5.95% for lac.225 og 2.26% for lac.375. Dette betyr at for lac.225 er det en betydelig større variasjon i dataene sammenlignet med lac. 375, som har lavere SD. Samtidig indkikerer begge resultatene at det er en viss usikkerhet i målingene.\n\n## Del 2: Predikere størrelse på DNA-fragmenter\n\n### Introduksjon\n\nI denne delen av oppgaven ser vi nærmere på forsøket vi gjennomførte på molekylærlabben, hvor vi ekstraherte DNA fra blodprøver. Her ønsket vi å isolere gener relatert til hurtig (R/R) og langsom (X/X) muskelfibre ved hjelp av en PCR maskin. Deretter ble prøvene analysert gjennom elektroforese i agarosegel, sammen med en DNA-ladder som fungerer som markør for å kartlegge genene. DNA-ladderen markerer hvert tiende basepar (bp) opp til 300bp og hvert hundrede basepar videre til 1000bp. De dominante R/R-genene har størrelse på 413bp, mens X/X-genene har en størrelse på 318bp. PÅ grunn av forskjellen i størrelse, vil de mindre X/X-genene trekke lenger inn i gelen under selve elektroforesen. Dette er imidlertid vanskelig å vurdere nøyaktig med bare øynene. For å få mer pålitelig resultat, har vi benyttet en metode for å analysere prøvene for mer presise målinger.\n\n### Metode\n\n\"For å analysere DNA-prøvene, brukte vi ImageJ til å behandle bildene som ble tatt etter elekroforesen. Først inverterte vi bildene for å forbedre kontrasten, der etter justerte vi dem slik at de var riktig justert, og klippet ut den relevante delen av bildet for videre analyse. Videre markerte vi stigen og prøvene vi ønsket å analysere, og ut fra de markerte områdene lagde vi grafer for hver brønn. \"\n\nFor å analysere DNA-fragmentene målte vi migrasjonsavtandene i gelen ved hjelp av ImageJ. Vi markerte toppunktene i grafene som representerer både genene i prøvene og trinnene i DNA-ladderen. ImageJ registrerte nøyaktig plassering av disse punktene, og koordiantene ble flyttet til et Excel-ark for videre beregning i R. Her brutke vi den kjente DNA-ladderen til å lage en standardkurve ved å relatere migrasjonsavstanden til størrelsen på fragmentene i bp. Tilslutt benyttet vi en lineær regresjonsmodell for å estimere størrelsen på DNA-fragmentene i våre ukjente prøver.\n\n### Målinger\n\n```{r}\n\nlibrary(readxl)\ndat <- read_excel(\"data/resultat_dna_analyse.xlsx\")\n\n```\n\nVi starter med å kalibrere DNA-stigen for å bestemme molekylstørrelsen på de ukjente prøvene. Dette kan vi gjøre ved å lage en data.frame kalt \"ladder\", der vi bruker verdiene som er omvendt proposjonale, ettersom små molekyler beveger seg lengre i gelen. Deretter kan vi lage en annen data.frame for de ukjente prøvene, som vi kaller \"unknown\", for videre analyse.\n\n```{r}\n\nladder <- data.frame(\n  dist = c(36, 59.5, 86.5, 119.5, 159.5, 208.5, 269.5, 351.5, 396.5, 455.5, 521.5, 599.5, 701.5),\n  mw = c(1000, 900, 800, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50)\n)\n\nunknown <- data.frame(\n  dist = c(258.5, 262.5, 265.5, 335.5)\n)\n\n```\n\nFor å lage en kalibreringsmodell bruker vi dataene fra stigen til å lage en ggplot som visualiserer stigens forhold. Deretter bruker vi denne grafen til å estimere størrelsen på de ukjente prøvene. Vi benytter en polynomfunksjon (poly) for å tilpasse en kurve som gir minst mulig avvik fra datane.\n\n```{r}\n\nlibrary(tidyverse)\n\ndata <- data.frame(\n  x = c(36, 59.5, 86.5, 119.5, 159.5, 208.5, 269.5, 351.5, 396.5, 455.5, 521.5, 599.5, 701.5),\n  y = c(1000, 900, 800, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50)\n)\n\nggplot(data = data, aes(x, y)) +\n  geom_point() + \n  geom_smooth(method = \"lm\", formula = y ~ poly(x, 2), color = \"green\", se = FALSE) +\n  scale_y_continuous(limits = c(0, 1000)) + \n  scale_x_continuous(limits = c(0, 750)) +\n  labs(x = \"Avstand (mm)\", y = \"Molekylvekt (Da)\", title = \"Kalibreringsmodell\")\n\n\n```\n\nVidere kan vi bruke vi følgende koder for å estimere molekylstørrelsen på genene i prøven vår.\n\n```{r, results='hide'}\n\ncal <- lm(log(mw) ~ dist, data = ladder)\n\nsummary(cal)\n\npreds <- exp(predict(cal, newdata = unknown))\n\nunknown$predicted_mw <- preds\n\n\n```\n\nResultatene viser at kalibreringsmodellen har høy prediktiv nøyaktighet, med et R-squared på 0.9895, som tilsier at modellen forklarer nesten 99% av variasjonen i molekylvektene basert på migrasjonsavstanden.\n\nTil slutt, brukte vi følgende koder for å estimere molekylstørrelsen på genene i prøven vår:\n\n```{r, results='hide'}\n\nladder <- data.frame(\n  dist = c(36, 59.5, 86.5, 119.5, 159.5, 208.5, 269.5, 351.5, 396.5, 455.5, 521.5, 599.5, 701.5),\n  mw = c(1000, 900, 800, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50)\n)\n\ncal <- lm(log(mw) ~ dist, data = ladder)\n\nsummary(cal)\n\nunknown <- data.frame(dist = c(258.5, 262.5, 265.5, 335.5))\n\npreds <- exp(predict(cal, newdata = unknown))\n\npreds\n\n\n```\n\nResultatene viser de estimerte molekylvektene (bp) for de ukjente DNA-fragmentene basert på deres migrasjonsavstand i gelen. Noe som gav oss følgende størrelser:\n\n-   Prøve 1: 407.5 bp\n-   Prøve 2: 400.7 bp\n-   prøve 3: 395.7 bp\n-   prøve 4: 295.2 bp\n\n## Diskusjon\n\nResultatene fra kalibreringsmodellen viste høy nøyaktighet med en R-squared på 0.9895, noe som tyder at vi kan stole på de estimerte molekylvektene for de ukjente prøvene. Ser vi på de estimerte molekylvektene (407.5, 400.7, 395.7 bp og 295.2 bp) stemmer godt overens med de kjente størrelsene for R/R-genet (413) og X/X-genet (318 bp). De fleste prøvene er nær 400 bp, som indikerer at de inneholder R/R-genene, mens den lavere verdien (295.2 bp) kan tilhøre X/X-genet.\n\nNoen faktorer som kan påvirke resultatene er bildekvalitet og variasjon i elektroforesen, som kan føre til små avvik i migrasjonsavstandene. Likevel, de estimerte størrelsene er konsistente med forventningene, og metoden gir en pålitelig tilnærming for å bestemme molekylvektene i DNA-prøvene våre.\n","srcMarkdownNoYaml":"\n\n## Introduksjon\n\nDenne oppgaven er delt inn i tre deler, som hver fokuserer på ulike konsepter innen dataanalyse og regresjon. I del 1 beregner vi laktatterskler og undersøker reliabiliteten mellom to ulike terskelnivåer. I del 2 benytter vi molekylære data for å forutsi størrelsen på DNA-fragmenter. Til slutt, i del 3, undersøker vi om det er en lineær sammenheng mellom valgte variabler fra datasettet hypertrophy i datapakken exscidata.\n\n## Del 1: Laktatterskler\n\n### Introduksjon\n\nLaktatterskel er en vitkig variabel for å predikere prestasjoner i utholdenhetsidretter, og brukes både til å justere treningsintenistet og evaluere effekten av trening (@Machado2012). Det finnes flere metoder for å bestemme en utøvers laktatterskel, og ifølge @Machado2012 er \"maximal-deviation method\" (Dmax), som ble anbefalt av Cheng et al. i 1992, en av de mest pålitelige. Denne metoden er spesielt nyttig for å vurdere mekanismene som påvirker prestasjon i langdistanseidretter, og har vist seg å ha en sterkere korrelasjon med både prestasjon og laktatterskel sammenlignet med andre metoder. De representative tersklene som blir undersøkt er (). Dette kan oppnås ved å bruke en regresjonsmodell for å beskrive forholdet, og deretter utføre en \"invers prediksjon\" av treningsintensiteten @Tanner2012.\n\n### Metode\n\nSom vi kan se i den plotta grafen under, er de forskjellige grafene ikke så forskjellige rundt 2mmol og 4mmol L\\~-1. På den andre siden ser vi at den lineære modellen er feil ved 300w, den sekundærplynomiske modellen er feil ved 275w. Den tredje- og fjerdeplynomiske modellen derimot, varierer ikke mye fra hverandre.\n\n```{r}\n\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(exscidata)\nlibrary(knitr)\n\ndata(\"cyclingstudy\")\n\ncyclingstudy %>%\n  select(subject, group, timepoint, lac.225:lac.375) %>%\n  filter(timepoint == \"pre\", subject == 10) %>%\n  pivot_longer(\n    cols = lac.225:lac.375,\n    names_to = \"watt\",\n    values_to = \"lactate\",\n    names_prefix = \"lac.\",\n    names_transform = list(watt = as.numeric)\n  ) %>%\n\n    ggplot(aes(x = watt, y = lactate, group = subject)) +\n  geom_line(linetype = 2) + \n  geom_point(shape = 21, fill = \"lightblue\", size = 2.5) +  \n  \n  geom_hline(yintercept = 4, color = \"red\") +\n  geom_hline(yintercept = 2, color = \"gold\") +\n  \n  geom_vline(xintercept = 341.5, color = \"blue\") +\n  geom_vline(xintercept = 308, color = \"green\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ x, color = \"#e41a1c\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ poly(x, 2), color = \"#377eb8\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ poly(x, 3), color = \"#4daf4a\") +\n  \n  geom_smooth(method = \"lm\", se = FALSE, formula = y ~ poly(x, 4), color = \"#ff7f00\")\n\n\n```\n\nFor å finne ut hva forutsatt wattverdi som er nærmest 2 og 4 mmol L-1, benytter vi koden under:\n\n```{r}\n\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(exscidata)\nlibrary(knitr)\n\ndata(\"cyclingstudy\")\n\n# Filter data\ncycling_filtered <- cyclingstudy %>%\n  select(subject, group, timepoint, lac.225:lac.375) %>%\n  filter(timepoint == \"pre\", subject == 10) %>%\n  pivot_longer(\n    cols = lac.225:lac.375,\n    names_to = \"watt\",\n    values_to = \"lactate\",\n    names_prefix = \"lac.\",\n    names_transform = list(watt = as.numeric)\n  )\n\n# Tilpass en polynommodell av 3. grad\nm3 <- lm(lactate ~ poly(watt, 3), data = cycling_filtered)\n\n# Ny dataramme for prediksjoner\nndf <- data.frame(watt = seq(from = 225, to = 375, by = 0.1))\nndf$predictions <- predict(m3, newdata = ndf)\n\n# Finn wattverdiene nærmest 2 mmol/L og 4 mmol/L\nlactate_threshold_2 <- ndf %>%\n  filter(abs(predictions - 2) == min(abs(predictions - 2)))\n\nlactate_threshold_4 <- ndf %>%\n  filter(abs(predictions - 4) == min(abs(predictions - 4)))\n\n# Resultater\nprint(lactate_threshold_2)\nprint(lactate_threshold_4)\n\n# Plot data and the model\nggplot(cycling_filtered, aes(x = watt, y = lactate)) +\n  geom_point(shape = 21, fill = \"lightblue\", size = 2.5) +  # Plot the data points\n  geom_line(color = \"black\", linetype = \"dashed\") +  # Add the line for the model\n  geom_hline(yintercept = c(2, 4), color = c(\"gold\", \"red\"), linetype = \"dotted\") +  # Add horizontal lines for 2 and 4 mmol/L\n  geom_vline(xintercept = lactate_threshold_2$watt, color = \"green\", linetype = \"solid\") +  # Vertical line for 2 mmol/L\n  geom_vline(xintercept = lactate_threshold_4$watt, color = \"blue\", linetype = \"solid\") +  # Vertical line for 4 mmol/L\n  theme_minimal() +\n  labs(title = \"Laktatnivå versus Watt\", x = \"Watt\", y = \"Laktatnivå\")\n\n```\n\nRegresjonsanalysen viser at wattverdien som gir et laktatnivå på 2 mmol L-1 er omtrent 311 watt. Når intensiteten når 311 watt, forventes laktatnivået å være nær 2 mmol L-1. laktatnivået på 4 mmol L-1, ligger predikerte wattverdien på 343 watt. Disse resultatene kan brukes til å vurdere intenisten på treningsøktene i forhold til laktatterskelene.\n\nFor å sammenligne reliabiliten (SD som en prosent av gjennomsnittet) mellom lac.225 og lac.375, kan vi formulere koden slik:\n\n```{r, results='hide'}\n\n# Filtrer ut NA-verdier for lac.225 og lac.375\nlac_data_225 <- cyclingstudy %>%\n  filter(!is.na(lac.225)) %>%\n  select(subject, lac.225)\n\nlac_data_375 <- cyclingstudy %>%\n  filter(!is.na(lac.375)) %>%\n  select(subject, lac.375)\n\n# Sjekk antall rader i dataene for lac.225 og lac.375\ncat(\"Antall rader i lac_data_225:\", nrow(lac_data_225), \"\\n\")\ncat(\"Antall rader i lac_data_375:\", nrow(lac_data_375), \"\\n\")\n\n# Beregn standardfeil, gjennomsnitt og prosentandel for lac.225\nse_lac225 <- sd(lac_data_225$lac.225) / sqrt(length(lac_data_225$lac.225))\nmean_lac225 <- mean(lac_data_225$lac.225)\nperc_se_lac225 <- (se_lac225 / mean_lac225) * 100\n\n# Beregn standardfeil, gjennomsnitt og prosentandel for lac.375\nse_lac375 <- sd(lac_data_375$lac.375) / sqrt(length(lac_data_375$lac.375))\nmean_lac375 <- mean(lac_data_375$lac.375)\nperc_se_lac375 <- (se_lac375 / mean_lac375) * 100\n\n# Skriv ut resultatene\ncat(\"Typisk feil som prosentandel for lac.225:\", perc_se_lac225, \"%\\n\")\ncat(\"Typisk feil som prosentandel for lac.375:\", perc_se_lac375, \"%\\n\")\n\n\n```\n\nResultatene viser at den typiske feilen som prosentandel av gjennomsnittet er 5.95% for lac.225 og 2.26% for lac.375. Dette betyr at for lac.225 er det en betydelig større variasjon i dataene sammenlignet med lac. 375, som har lavere SD. Samtidig indkikerer begge resultatene at det er en viss usikkerhet i målingene.\n\n## Del 2: Predikere størrelse på DNA-fragmenter\n\n### Introduksjon\n\nI denne delen av oppgaven ser vi nærmere på forsøket vi gjennomførte på molekylærlabben, hvor vi ekstraherte DNA fra blodprøver. Her ønsket vi å isolere gener relatert til hurtig (R/R) og langsom (X/X) muskelfibre ved hjelp av en PCR maskin. Deretter ble prøvene analysert gjennom elektroforese i agarosegel, sammen med en DNA-ladder som fungerer som markør for å kartlegge genene. DNA-ladderen markerer hvert tiende basepar (bp) opp til 300bp og hvert hundrede basepar videre til 1000bp. De dominante R/R-genene har størrelse på 413bp, mens X/X-genene har en størrelse på 318bp. PÅ grunn av forskjellen i størrelse, vil de mindre X/X-genene trekke lenger inn i gelen under selve elektroforesen. Dette er imidlertid vanskelig å vurdere nøyaktig med bare øynene. For å få mer pålitelig resultat, har vi benyttet en metode for å analysere prøvene for mer presise målinger.\n\n### Metode\n\n\"For å analysere DNA-prøvene, brukte vi ImageJ til å behandle bildene som ble tatt etter elekroforesen. Først inverterte vi bildene for å forbedre kontrasten, der etter justerte vi dem slik at de var riktig justert, og klippet ut den relevante delen av bildet for videre analyse. Videre markerte vi stigen og prøvene vi ønsket å analysere, og ut fra de markerte områdene lagde vi grafer for hver brønn. \"\n\nFor å analysere DNA-fragmentene målte vi migrasjonsavtandene i gelen ved hjelp av ImageJ. Vi markerte toppunktene i grafene som representerer både genene i prøvene og trinnene i DNA-ladderen. ImageJ registrerte nøyaktig plassering av disse punktene, og koordiantene ble flyttet til et Excel-ark for videre beregning i R. Her brutke vi den kjente DNA-ladderen til å lage en standardkurve ved å relatere migrasjonsavstanden til størrelsen på fragmentene i bp. Tilslutt benyttet vi en lineær regresjonsmodell for å estimere størrelsen på DNA-fragmentene i våre ukjente prøver.\n\n### Målinger\n\n```{r}\n\nlibrary(readxl)\ndat <- read_excel(\"data/resultat_dna_analyse.xlsx\")\n\n```\n\nVi starter med å kalibrere DNA-stigen for å bestemme molekylstørrelsen på de ukjente prøvene. Dette kan vi gjøre ved å lage en data.frame kalt \"ladder\", der vi bruker verdiene som er omvendt proposjonale, ettersom små molekyler beveger seg lengre i gelen. Deretter kan vi lage en annen data.frame for de ukjente prøvene, som vi kaller \"unknown\", for videre analyse.\n\n```{r}\n\nladder <- data.frame(\n  dist = c(36, 59.5, 86.5, 119.5, 159.5, 208.5, 269.5, 351.5, 396.5, 455.5, 521.5, 599.5, 701.5),\n  mw = c(1000, 900, 800, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50)\n)\n\nunknown <- data.frame(\n  dist = c(258.5, 262.5, 265.5, 335.5)\n)\n\n```\n\nFor å lage en kalibreringsmodell bruker vi dataene fra stigen til å lage en ggplot som visualiserer stigens forhold. Deretter bruker vi denne grafen til å estimere størrelsen på de ukjente prøvene. Vi benytter en polynomfunksjon (poly) for å tilpasse en kurve som gir minst mulig avvik fra datane.\n\n```{r}\n\nlibrary(tidyverse)\n\ndata <- data.frame(\n  x = c(36, 59.5, 86.5, 119.5, 159.5, 208.5, 269.5, 351.5, 396.5, 455.5, 521.5, 599.5, 701.5),\n  y = c(1000, 900, 800, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50)\n)\n\nggplot(data = data, aes(x, y)) +\n  geom_point() + \n  geom_smooth(method = \"lm\", formula = y ~ poly(x, 2), color = \"green\", se = FALSE) +\n  scale_y_continuous(limits = c(0, 1000)) + \n  scale_x_continuous(limits = c(0, 750)) +\n  labs(x = \"Avstand (mm)\", y = \"Molekylvekt (Da)\", title = \"Kalibreringsmodell\")\n\n\n```\n\nVidere kan vi bruke vi følgende koder for å estimere molekylstørrelsen på genene i prøven vår.\n\n```{r, results='hide'}\n\ncal <- lm(log(mw) ~ dist, data = ladder)\n\nsummary(cal)\n\npreds <- exp(predict(cal, newdata = unknown))\n\nunknown$predicted_mw <- preds\n\n\n```\n\nResultatene viser at kalibreringsmodellen har høy prediktiv nøyaktighet, med et R-squared på 0.9895, som tilsier at modellen forklarer nesten 99% av variasjonen i molekylvektene basert på migrasjonsavstanden.\n\nTil slutt, brukte vi følgende koder for å estimere molekylstørrelsen på genene i prøven vår:\n\n```{r, results='hide'}\n\nladder <- data.frame(\n  dist = c(36, 59.5, 86.5, 119.5, 159.5, 208.5, 269.5, 351.5, 396.5, 455.5, 521.5, 599.5, 701.5),\n  mw = c(1000, 900, 800, 700, 600, 500, 400, 300, 250, 200, 150, 100, 50)\n)\n\ncal <- lm(log(mw) ~ dist, data = ladder)\n\nsummary(cal)\n\nunknown <- data.frame(dist = c(258.5, 262.5, 265.5, 335.5))\n\npreds <- exp(predict(cal, newdata = unknown))\n\npreds\n\n\n```\n\nResultatene viser de estimerte molekylvektene (bp) for de ukjente DNA-fragmentene basert på deres migrasjonsavstand i gelen. Noe som gav oss følgende størrelser:\n\n-   Prøve 1: 407.5 bp\n-   Prøve 2: 400.7 bp\n-   prøve 3: 395.7 bp\n-   prøve 4: 295.2 bp\n\n## Diskusjon\n\nResultatene fra kalibreringsmodellen viste høy nøyaktighet med en R-squared på 0.9895, noe som tyder at vi kan stole på de estimerte molekylvektene for de ukjente prøvene. Ser vi på de estimerte molekylvektene (407.5, 400.7, 395.7 bp og 295.2 bp) stemmer godt overens med de kjente størrelsene for R/R-genet (413) og X/X-genet (318 bp). De fleste prøvene er nær 400 bp, som indikerer at de inneholder R/R-genene, mens den lavere verdien (295.2 bp) kan tilhøre X/X-genet.\n\nNoen faktorer som kan påvirke resultatene er bildekvalitet og variasjon i elektroforesen, som kan føre til små avvik i migrasjonsavstandene. Likevel, de estimerte størrelsene er konsistente med forventningene, og metoden gir en pålitelig tilnærming for å bestemme molekylvektene i DNA-prøvene våre.\n"},"formats":{"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":"html_document","warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"02-regression-models.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["idr-4000-referanser.bib","resources/idr-4000-referanser.bib"],"title":"Regression Models","author":"Andrine Juvodden, gruppeoppgave","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["pdf"]}